var Optimizely_RS=function(e){"use strict";function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r(n.key),n)}}function i(e,t,i){return(t=r(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function r(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var n,a=4,o=function(e){switch(e.toUpperCase()){case"INFO":a=1;break;case"DEBUG":a=2;break;case"WARN":a=3;break;default:a=4}},s=function(){var e;a<=2&&(e=console).log.apply(e,arguments)},c="OPTIMIZELY";i({},"Optimizely Web","Optimizely"),i(n={},c,c),i(n,"Optimizely",c),i(n,"optimizely",c);var p=function(){function e(t,r,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"referrerOverride",(function(e){if(e)return window.optimizelyEffectiveReferrer=e,e})),i(this,"sendDataToRudder",(function(e){s(e);var t=e.experiment,i=e.variation,r={integrations:{All:!0}},n=e.audiences,o=e.campaignName,c=e.id,p=e.isInCampaignHoldback,d={};n.forEach((function(e){d[e.id]=e.name}));var l=Object.keys(d).sort((function(e,t){return e.localeCompare(t)})).join(),m=Object.values(d).sort((function(e,t){return e.localeCompare(t)})).join(", ");if(a.sendExperimentTrack){var u={campaignName:o,campaignId:c,experimentId:t.id,experimentName:t.name,variationName:i.name,variationId:i.id,audienceId:l,audienceName:m,isInCampaignHoldback:p};t.referrer&&(u.referrer=t.referrer,r.page={referrer:t.referrer}),a.sendExperimentTrackAsNonInteractive&&(u.nonInteraction=1),u=function(e,t,i){var r=e;return t&&i.length>0&&i.forEach((function(e){var t=i[e].from,n=i[e].to;void 0!==r[n]&&(r[t]=r[n],delete r[n])})),r}(u,e,a.customCampaignProperties),a.analytics.track("Experiment Viewed",u,r)}if(a.sendExperimentIdentify){var v={};v["Experiment: ".concat(t.name)]=i.name,a.analytics.identify(v)}})),r.logLevel&&o(r.logLevel),this.analytics=r,this.sendExperimentTrack=t.sendExperimentTrack,this.sendExperimentIdentify=t.sendExperimentIdentify,this.sendExperimentTrackAsNonInteractive=t.sendExperimentTrackAsNonInteractive,this.revenueOnlyOnOrderCompleted=t.revenueOnlyOnOrderCompleted,this.trackCategorizedPages=t.trackCategorizedPages,this.trackNamedPages=t.trackNamedPages,this.customCampaignProperties=t.customCampaignProperties?t.customCampaignProperties:[],this.customExperimentProperties=t.customExperimentProperties?t.customExperimentProperties:[],this.name=c;var p=null!=n?n:{};this.shouldApplyDeviceModeTransformation=p.shouldApplyDeviceModeTransformation,this.propagateEventsUntransformedOnError=p.propagateEventsUntransformedOnError,this.destinationId=p.destinationId}var r,n,a;return r=e,(n=[{key:"init",value:function(){s("=== in optimizely init ==="),this.initOptimizelyIntegration(this.referrerOverride,this.sendDataToRudder)}},{key:"isLoaded",value:function(){return!(!window.optimizely||window.optimizely.push===Array.prototype.push)}},{key:"isReady",value:function(){return!(!window.optimizely||window.optimizely.push===Array.prototype.push)}},{key:"initOptimizelyIntegration",value:function(e,t){var i=function(e,i){try{var r,n=null===(r=window)||void 0===r||null===(r=r.optimizely)||void 0===r?void 0:r.get("state");if(n){var a=n.getCampaignStates({isActive:!0})[e];i&&(a.experiment.referrer=i),t(a)}}catch(o){s("Page loaded without Optimizely.")}},r=function(){var t;try{var i;t=null===(i=window)||void 0===i||null===(i=i.optimizely)||void 0===i?void 0:i.get("state")}catch(n){t=void 0}if(t){var r=t.getRedirectInfo()&&t.getRedirectInfo().referrer;if(r)return e(r),r}};!function(){var e;window.optimizely=window.optimizely||[];try{var t;e=null===(t=window)||void 0===t||null===(t=t.optimizely)||void 0===t?void 0:t.get("state")}catch(o){e=void 0}if(e){var n=r(),a=e.getCampaignStates({isActive:!0});Object.keys(a).forEach((function(e){n?i(e,n):i(e)}))}else window.optimizely.push({type:"addListener",filter:{type:"lifecycle",name:"initialized"},handler:function(){r()}})}(),window.optimizely.push({type:"addListener",filter:{type:"lifecycle",name:"campaignDecided"},handler:function(e){var t=e.data.campaign.id;i(t)}})}},{key:"track",value:function(e){s("in Optimizely web track");var t=e.message.properties,i=e.message.event;t.revenue&&this.revenueOnlyOnOrderCompleted&&("Order Completed"===i?t.revenue=Math.round(100*t.revenue):"Order Completed"!==i&&delete t.revenue);var r={type:"event",eventName:i.replace(/:/g,"_"),tags:t};window.optimizely.push(r)}},{key:"page",value:function(e){s("in Optimizely web page");var t=e,i=t.message.properties.category,r=t.message.name;i&&this.trackCategorizedPages&&(t.message.event="Viewed ".concat(i," page"),t.message.type="track",this.track(t)),r&&this.trackNamedPages&&(t.message.event="Viewed ".concat(r," page"),t.message.type="track",this.track(t))}}])&&t(r.prototype,n),a&&t(r,a),Object.defineProperty(r,"prototype",{writable:!1}),e}();return e.Optimizely=p,e}({});
//# sourceMappingURL=Optimizely.min.js.map
